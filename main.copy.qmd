---
title: DSAN-5300 Final Project
date: today
author: 'Hannah Kim, Irene Tait, Kendall Gilbert, Powell Sheagren'
format:
  html:
    embed-resources: true
jupyter:
  kernelspec:
    display_name: R
    language: R
    name: ir
---

## Tegression 

Logistic Regression on Tidyset

```{R}
tidyset <- read_csv("~/Desktop/5300FinalProject/data/tidyset.csv")
library(caret)
library(glmnet)

#Logistic Regression
logistic_model_tidyset <- glm(is_business ~., data = tidyset, family = binomial)
summary(logistic_model_tidyset)
```
```{R}
#Lasso Logistic 
y <- tidyset$is_business
x <- model.matrix(is_business ~ ., data = tidyset)
x <- as.matrix(x)
cv_model <- cv.glmnet(x, y, alpha = 1)
best_lambda <- cv_model$lambda.min
best_lambda
lass_log_coefs <- coef(cv_model, s = best_lambda)
lass_log_coefs
plot(cv_model)
```

```{R}
#Ridge Logistic
tidyset <- na.omit(tidyset)
y <- tidyset$is_business
x <- model.matrix(is_business ~ ., data = tidyset)
x <- as.matrix(x)
cv_model <- cv.glmnet(x, y, alpha = 0)
best_lambda <- cv_model$lambda.min
best_lambda
lass_log_coefs <- coef(cv_model, s = best_lambda)
lass_log_coefs
plot(cv_model)
```


Linear Regression
```{R}
linear_model_tidyset <- lm(ConsumptionTarget ~., data = tidyset)
summary(linear_model_tidyset)
```

```{R}
#Linear Lasso
tidyset <- na.omit(tidyset)
x <- model.matrix(ConsumptionTarget ~ ., data = tidyset)
y <- tidyset$ConsumptionTarget
lasso_model <- cv.glmnet(x, y, alpha = 1)
plot(lasso_model)
best_lambda <- lasso_model$lambda.min
best_lambda
lasso_coefs <- coef(lasso_model, s = best_lambda)
lasso_coefs
```

```{R}
#Linear Lasso
tidyset <- na.omit(tidyset)
x <- model.matrix(ConsumptionTarget ~ ., data = tidyset)
y <- tidyset$ConsumptionTarget
lasso_model <- cv.glmnet(x, y, alpha = 0)
plot(lasso_model)
best_lambda <- lasso_model$lambda.min
best_lambda
lasso_coefs <- coef(lasso_model, s = best_lambda)
lasso_coefs
```


